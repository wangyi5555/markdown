# [TCP/IP](http://jm.taobao.org/2017/06/08/20170608/ )



特点

- 三次握手
- 四次挥手
- 可靠传输
- 丢包重传

> 如何保证可靠传输

1. 应答机制：接收端收到数据包后会发送一个响应包
2. 超时发送：发送端发送一个数据包后会启动一个定时器等待接受一个响应包，如果超时后仍没接受到则重发
3. 数据包校验：出错后直接丢弃不给出回应，发送端长时间没接收到回应会自动重发
4. 失序包重新排序
5. 丢弃重复数据
6. 流量控制：每端都有一个固定的缓冲空间，接受端只允许另一端发送
7. 快重传：提高数据包校验的速度：当接收端收到失序报文后发送3次对上一报文的确定，发送端接受到这三次确认报文后就重新发送该数据包，这样做可以加快确认的速度，不用等到定时器溢出才检测到

> 拥塞控制

1. 拥塞控制：慢启动，指数增长
2. 到达==SSthresh==后网络出现拥塞，执行拥塞避免：加法增长
3. 网络拥塞达到最大时：重设==SSthresh===出现拥塞/2，然后从==SSthresh==重新开始（旧版本从0开始）

> 三次握手

- 第一步：client 发送 syn 到server 发起握手；
- 第二步：server 收到 syn后回复syn+ack给client；
- 第三步：client 收到syn+ack后，回复server一个ack表示收到了server的syn+ack

握手的核心目的是告知对方seq，对方回复ack（收到的seq+包的大小），这样发送端就知道有没有丢包了。 

握手过程确定可靠传输中的一些信息

- MSS–最大传输包
- SACK_PERM–是否支持Selective ack(用户优化重传效率）
- WS–窗口计算指数（有点复杂的话先不用管）

> 四次握手

- 第一步： client主动发送fin包给server
- 第二步： server回复ack（对应第一步fin包的ack）给client，表示server知道client要断开了
- 第三步： server发送fin包给client，表示server也可以断开了
- 第四步： client回复ack给server，表示既然双发都发送fin包表示断开，那么就真的断开吧

> 为什么[握手三次](https://blog.csdn.net/Shuffle_Ts/article/details/93778635)、[挥手四次](https://blog.csdn.net/Shuffle_Ts/article/details/93909003)

三次握手是防止客户端发送请求后出现延迟，此时服务端建立的连接就浪费了，如果第三次迟迟不来就断开

四次挥手提供缓冲，确保数据都被处理完



# UDP

不保证可靠连接，同时不需要维护连接，数据发送快，适合即时通讯业务

# 输入网站后浏览器的操作

1. 查询DNS来获取IP地址，
2. 发送请求建立TCP连接
3. 服务器接受到请求并返回处理好的结果
4. 客户端收到响应在浏览器渲染出来